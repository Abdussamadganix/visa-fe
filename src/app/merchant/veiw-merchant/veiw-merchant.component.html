<!-- navbar-->
<!-- Breadcrumb-->
<div class="breadcrumb-holder">
  <div class="container-fluid">
    <ul class="breadcrumb">
      <li class="breadcrumb-item"><a routerLink="/dashboard">Home</a></li>
      <li class="breadcrumb-item active">Merchant</li>
    </ul>
  </div>
</div>
<section>
  <div class="container-fluid">
    <!-- Page Header-->
    <header>
      <!-- <button (click)="addNewRole()">Add Merchant</button> -->
    </header>
    <div class="row" [ngSwitch]="whichForm">
      <div class="col-lg-12" *ngSwitchCase="'viewMerchant'">
        <div class="card">
          <div class="card-header">
            <h4>Merchant</h4>
          </div>
          <div style="border: 1px solid rgb(240, 236, 236) !important; padding: 15px">
              <div class="row">
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="reg-label">Start Date</label>
                    <input id="startDate" type="date" #startDate class="form-control" />
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label class="reg-label">End date</label>
                    <input id="endDate" type="date" #endDate class="form-control" />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-1">
                  <div class="form-group">
                    <input type="submit" (click)="newSearch()" value="Search">
                  </div>
                </div>
                <div class="col-md-1">
                  <div class="form-group">
                    <input type="button"  (click)="downloadReportExcel()" value="download">
                  </div>
                </div>
              </div>
            </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead>
                  <tr>
                    <th class="th-sm">S/N</th>
                    <th class="th-sm">Name</th>
                    <th class="th-sm">Merchant Id</th>
                    <th class="th-sm">Business Type</th>
                    <th class="th-sm">Date Created</th>
                    <th class="th-sm">Date Updated</th>
                    <th class="th-sm">Status</th>
                    <!-- <th class="th-sm">Action
                          </th> -->
                  </tr>
                </thead>
                <tbody>
                  <!-- *ngFor="let item zf stream | async as list" -->
                  <tr *ngFor="let merchant  of merchants.content let i = index" (click)="editMerchantForm(merchant)">
                    <td>{{ i + 1}}</td>
                    <td><a title="click here to veiw more details" style="color: cadetblue;">{{
                        merchant.name}} </a></td>
                    <td>{{ merchant.key}}</td>
                    <td>{{merchant.businessType}}</td>
                    <td>{{ merchant.createdAt}}</td>
                    <td>{{ merchant.updatedAt}}</td>
                    <td>
                      <h5><span *ngIf="merchant.status == 'ACTIVE'"
                          class="xp-status status_active">{{merchant.status}}</span>
                        <span *ngIf="merchant.status == 'INACTIVE'"
                          class="xp-status status_inactive">{{merchant.status}}</span>
                      </h5>
                    </td>
                    <!-- <td>
                            <div><span><button (click)="editMerchantForm(merchant)" type="button" style="padding: 10px 24px; border-radius: 12px;" class="btn badge badge-primary"
                                  role="button" aria-pressed="true">View</button></span></div>
                          </td> -->
                  </tr>
                </tbody>
              </table>
              <div>
                <div class="container">
                    <div class="text-center">             
                        <!-- pager -->
                        <nav aria-label="Page navigation example">
                        <ul *ngIf="pager.pages && pager.pages" class="pagination">
                            <li class="page-item" [ngClass]="{disabled:pager.currentPage === 1}">
                                <a class="page-link" (click)="newSearch(1, 'paginate')">First</a>
                            </li>
                            <li class="page-item" [ngClass]="{disabled:pager.currentPage === 1}">
                                <a class="page-link" (click)="newSearch(pager.currentPage - 1, 'paginate')">Previous</a>
                            </li>
                            <li class="page-item" *ngFor="let page of pager.pages" [ngClass]="{active:pager.currentPage === page}">
                                <a  class="page-link" (click)="newSearch(page, 'paginate')">{{page}}</a>
                            </li>
                            <li class="page-item" [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                                <a  class="page-link" (click)="newSearch(pager.currentPage + 1, 'paginate')">Next</a>
                            </li>
                            <li class="page-item" [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                                <a class="page-link" (click)="newSearch(pager.totalPages, 'paginate')">Last</a>
                            </li>
                        </ul>
                        </nav>
                    </div>
                </div>
            </div>          
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-12" *ngSwitchCase="'updateMerchant'">
        <div class="card">
          <div class="card-header d-flex align-items-center">
            <h4>Edit Merchant</h4>
            <div style="margin-left: 850px">
            <button *ngIf="fileAvailable" type="button" class="btn btn-primary"  style="border-radius: 2px; background: #33b35a !important;" (click)="downloadFile(merchantUnique);"
                      ><i class="fa fa-download"></i> Download file</button>
                      <button *ngIf="nofileUpload" type="button" class="btn btn-secondary"  style="border-radius: 2px; background: #d9004c !important;"
                      ><i class="fa fa-download"></i> No File to Download</button>
                    </div>
          </div>
          <div class="card-body">
            <form [formGroup]="editMerchantAdminForm" (ngSubmit)="updateMerchants(editMerchantAdminForm.value)">
              <div class="row">
                <div class="col-md-8">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Name</label>
                        <input disabled mdbInputDirective formControlName="name" type="text" class="form-control"
                          id="inputEmail4MD" placeholder="Name">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Email Address</label>
                        <input mdbInputDirective formControlName="email" type="email" class="form-control"
                          id="inputEmail4MD" placeholder="Email">
                      </div>
                    </div>

                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Select Bank</label>
                        <select class="form-control" id="bankCode" formControlName="bankCode">
                          <option value="bankCode" disabled selected>Select Bank</option>
                          <option *ngFor="let bank of banks" value="{{bank.bankCode}}" style="color: black !important;">
                            {{bank.bankName}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Settlement Account</label>
                        <input mdbInputDirective formControlName="settlementAccountNumber" type="text"
                          class="form-control" id="inputSettlementAccountNumberMD"
                          placeholder="Settlement Account Number">
                      </div>
                    </div>

                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Business Type</label>
                        <select class="form-control" id="businessType" formControlName="businessType">
                          <option value="buusinessType" disabled selected>Business Type</option>
                          <option value="REGISTERED" style="color: black !important;">REGISTERED</option>
                          <option value="STARTER" style="color: black !important;">STARTER</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Business Number</label>
                        <input mdbInputDirective formControlName="businessNumber" type="text" class="form-control"
                          id="inputBusinessNumber" placeholder="Business Number">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Processing fees</label>
                        <select class="form-control" id="isMerchantBearer" formControlName="isMerchantBearer">
                          <option value="chargesBearer" disabled selected>Processing fees</option>
                          <option value="ACTIVE" style="color: black !important;">YES</option>
                          <option value="INACTIVE" style="color: black !important;">NO</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Transaction Limit</label>
                        <input mdbInputDirective formControlName="transactionLimit" type="text" class="form-control"
                          id="inputTransactionLimit" placeholder="Transaction Limit">
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>Status</label> &nbsp;&nbsp;
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='statusChange' (onchange)='onCheckboxChange($event)'
                            formControlName="status" type="checkbox">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>Account Payment</label>
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='accountPayment' (onchange)='onCheckboxChange($event)'
                            formControlName="accountPayment" type="checkbox" data-on="Enabled">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>QR Payment</label>
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='qrPayment' (onchange)='onCheckboxChange($event)'
                            formControlName="qrPayment" type="checkbox">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>USSD Payment</label>
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='ussdPayment' (onchange)='onCheckboxChange($event)'
                            formControlName="ussdPayment" type="checkbox">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>Wallet Payment</label>
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='walletPayment' (onchange)='onCheckboxChange($event)'
                            formControlName="walletPayment" type="checkbox">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>Card Payment</label>
                        <label class="switch" style="float: right;">
                          <input [(ngModel)]='cardPayment' (onchange)='onCheckboxChange($event)'
                            formControlName="cardPayment" type="checkbox">
                          <span class="slider round"></span>
                        </label>
                      </div>
                    </div>
                    <!-- <div class="pdf-container">
                      <pdf-viewer [src]="src"
                                  [original-size]="false"
                      ></pdf-viewer>
                    </div> -->
                    <!-- <div class="col-md-12"> -->
                        <div class="col-md-12">
                            <div class="form-group">
                              <label>Merchant Type</label>
                              <span style="float:right;"  >
                                    <select class="form-control" id="merchantType" formControlName="merchantType">
                                      <option  disabled="" selected="" value="merchantType" >Merchant Type</option>
                                      <option  style="color: black !important;" value="REGULAR">REGULAR</option>
                                      <option  style="color: black !important;" value="SCHOOL" >SCHOOL</option>
                                      <option  style="color: black !important;" value="REGULAR_SETTLE_DIFFERENT">FORIGEN SETTLEMENT</option>
                                    </select>
                                  </span>
                            </div>
                          </div>
                      
                        
                    
                      
                      <!-- </div> -->
                      <!-- <span *ngIf="nofileUpload != ''" style="padding: 10px;">{{ nofileUpload}}</span> -->
                    <!-- <div class="col-md-12">
                      <div class="form-group">
                        <button type="button" id="add" class="btn btn-info btn-rounded mb-4" style="margin-top: 30px"
                          (click)="buttonAdd();">
                          <i class="fas fa-plus"></i> Add Charge</button>&nbsp;
                      </div>
                    </div> -->
                  </div>
                </div>
                <div formArrayName="charges" class="col-md-12">
                  <div class="row"
                    *ngFor="let language of editMerchantAdminForm.controls.charges.controls; let i=index">
                    <div class="col-md-12" [formGroupName]="i">
                      <!-- <span *ngFor="let language of editMerchantAdminForm.controls.charges.controls; let i=index"> -->
                      <div class="row">
                        <div class="col-md-3">
                          <div class="form-group">
                            <label>Name</label>
                            <input type="text" class="form-control" class="form-control" formControlName="name">
                            <input type="hidden" class="form-control" class="form-control" formControlName="uniqueKey">
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="form-group">
                            <label>Type</label>
                            <select class="form-control" formControlName="chargeType">
                              <option value="FIXED">Fixed</option>
                              <option value="PERCENTAGE">Percentage</option>
                            </select>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="form-group">
                            <label>Value</label>
                            <input type="text" maxlength="3" class="form-control" class="form-control"
                              formControlName="value">
                          </div>
                        </div>
                        <div class="col-md-3" *ngIf="editMerchantAdminForm.controls.charges.controls.length > 1">
                          <div class="form-group">
                            <button type="button" class="btn btn-danger" (click)="removeCharges(i)"
                              style="margin-top:30px"><i class="fa fa-times"></i> Remove Charge</button>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- </span> -->
                  </div>
                  <div class="margin-20">
                    <a (click)="addCharges()" style="cursor: default">
                      Add Charge +
                    </a>
                  </div>
                </div>

              </div>

              <a class="download-zip-link" #downloadZipLink></a>
              <button (click)="goBack()" type="button" class="btn btn-default"
                style="margin-right: 5px;">Cancel</button>
              <button type="submit" [disabled]="isLoading" class="btn btn-success">Save Changes</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#fff" type="ball-scale-multiple">
  <p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner>
